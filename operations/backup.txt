Backup
======

Neo4j makes incremental backups using the transaction logs. You have to prepare the database by copying the current database. Once the database is copied, the transactions in the log will be applied to the backup database, to keep them in sync.

How to make backups in embedded mode
------------------------------------
First of, make sure your database is configured to keep logical logs around, like this:

----
keep_logical_logs=true <1>
----
WARNING: If you want to do incremental backups, you need to do make sure that logical logs are kept anytime you modify data or start up the database, otherwise you incremental backups might not work properly.

<1> See Configurations to see how you can give the database its settings.

Shut down the neo4j database and copy its files to the backup location. Once this is prepared, backups can be run by executing these Java statements:

// the first line of code in the example is too long in the PDF
.Java code to perform backup
[source,java]
----
EmbeddedGraphDatabase graphDb = getTheGraphDbFromApp(); // assume lucene is hooked into this instance
String location = "/var/backup/neo4j-db";
Backup backup = Neo4jBackup.allDataSources( graphDb, location );
backup.doBackup();
----
